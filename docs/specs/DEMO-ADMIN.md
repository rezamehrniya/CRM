# Spec دمو پنل CRM ساختار — نقش مدیر فروش (Admin)

**هدف:** تحویل یک پنل دمو قابل‌فروش برای CRM «ساختار» با تمرکز روی **نقش مدیر فروش** (Admin).

**خروجی:** Spec + Data + User Stories برای Tenant دمو با کاربر OWNER.

---

## ۱. نقش مدیر فروش (ادمین Tenant)

### دسترسی کامل به

- لیدها، مخاطبین، شرکت‌ها، معاملات، وظایف، فعالیت‌ها
- تنظیمات عمومی Tenant (کاربران، مراحل، اشتراک)
- مانیتورینگ وضعیت مشتریان (Customer 360)
- ساخت، ویرایش، حذف همه آیتم‌ها

---

## ۲. صفحات موجود در پنل

| صفحه            | مسیر                    | توضیح                                      |
|-----------------|-------------------------|--------------------------------------------|
| داشبورد         | `/dashboard`            | KPIهای کلی + alertهای فروش                |
| مخاطبین         | `/contacts`             | لیست + جستجو + مودال ساخت                  |
| جزئیات مخاطب    | `/contacts/:id`         | مشخصات کامل + فعالیت‌ها                   |
| شرکت‌ها          | `/companies`            | لیست شرکت‌ها                               |
| جزئیات شرکت     | `/companies/:id`        | مشخصات + مخاطبین + معاملات                 |
| معاملات         | `/deals`                | لیست کانبان + لیست معمولی                 |
| جزئیات معامله   | `/deals/:id`            | عنوان، مبلغ، مرحله، لینک مخاطب/شرکت       |
| کارها           | `/tasks`                | لیست وظایف روز                             |
| جزئیات کار      | `/tasks/:id`            | جزئیات کامل task                           |
| فعالیت‌ها       | `/activity`             | timeline تعاملات ثبت‌شده                   |
| ورود داده       | `/import`               | ایمپورت فایل CSV                          |
| تنظیمات         | `/settings`             | ماژول کاربران، مراحل، منابع لید            |
| اشتراک          | `/settings/billing`     | نمایش پلن و صندلی                          |
| Customer 360    | `/companies/:id/360` یا embed در detail | وضعیت کلی مشتری              |
| لاگین           | `/login`                | ورود به پنل demo با کاربر owner            |

---

## ۳. ساختار دادهٔ پیشنهادی برای دمو

### مخاطب (Contact)

- **نام:** علی رضایی
- **موبایل:** 09121234567
- **ایمیل:** ali@example.com
- **شرکت:** آلفا دیزاین
- **Stage:** گرم *(در صورت پشتیبانی مدل)*

### شرکت (Company)

- **نام:** آلفا دیزاین
- **وب‌سایت:** alfadezign.ir
- **صنعت:** طراحی داخلی *(در صورت پشتیبانی فیلد)*
- **مخاطب:** علی رضایی

### معامله (Deal)

- **عنوان:** CRM ویژه آلفا
- **مبلغ:** ۷۵ میلیون تومان
- **مرحله:** ارسال پیش‌فاکتور
- **شرکت:** آلفا دیزاین

### کار (Task)

- **عنوان:** پیگیری ارسال قرارداد
- **Due:** فردا
- **مربوط به:** معامله «CRM ویژه آلفا»

### فعالیت (Activity)

- **نوع:** تماس تلفنی
- **نتیجه:** موفق
- **یادداشت:** معرفی قابلیت‌های پنل فروش

---

## ۴. User Stories برای مدیر فروش (Admin Demo)

| نقش      | سناریو                               | نتیجه مورد انتظار                                                    |
|----------|--------------------------------------|----------------------------------------------------------------------|
| مدیر فروش | می‌خواهد مخاطب جدید ثبت کند          | فرم ساده + اختصاص به شرکت موجود یا جدید                              |
| مدیر فروش | می‌خواهد یک لید را پیگیری کند        | ثبت تماس / جلسه + تسک + Timeline قابل مشاهده                         |
| مدیر فروش | می‌خواهد lead را به مشتری تبدیل کند   | تبدیل فعال شود → ارتباط به شرکت و Contact برقرار شود                 |
| مدیر فروش | می‌خواهد وضعیت یک شرکت را ببیند       | در صفحه جزئیات شرکت، لیست مخاطبین + معاملات + 360 Summary            |
| مدیر فروش | می‌خواهد وظایف روزانه را ببیند        | صفحه Taskها + فیلتر کارهای من                                         |
| مدیر فروش | می‌خواهد اشتراک را چک کند            | در Settings → Billing اشتراک Basic فعال با صندلی 1/20 نمایش داده می‌شود |
| مدیر فروش | می‌خواهد تیم فروش را مدیریت کند      | در Settings → Users اعضا و نقش‌ها قابل مشاهده/تغییر است                |
| مدیر فروش | می‌خواهد دمو را با مشتری شبیه‌سازی کند | کل جریان فروش از Lead → Deal → Customer قابل طی شدن است               |

---

## ۵. الزامات فنی این دمو

- **Tenant** با slug `demo`
- **کاربر OWNER** با ایمیل `owner@demo.com` و رمز `12345678` (یا Bypass login)
- تمام دیتای بالا در **seed اولیه** ایجاد می‌شوند: `npx prisma db seed` (فایل `backend/prisma/seed.ts`)
- **Guard نقش‌ها** فعال؛ MEMBER نمی‌تواند تنظیمات را ببیند
- همه **routeهای detail** ساخته شده: `contacts/:id`, `companies/:id`, `deals/:id`, `tasks/:id`
- **Customer 360** به صورت embed در جزئیات شرکت یا مسیر `/companies/:id/360`

---

## ۶. ارجاعات

- [RBAC-PANELS.md](./RBAC-PANELS.md) — نقش‌ها و پنل‌ها
- [PRD-PANELS-USER-STORIES.md](./PRD-PANELS-USER-STORIES.md) — User Stories
- [API-CONTRACT.md](./API-CONTRACT.md) — قرارداد API
- [BILLING-SEATS.md](./BILLING-SEATS.md) — اشتراک و صندلی
